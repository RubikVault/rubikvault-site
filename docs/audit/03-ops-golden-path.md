# OPS Golden Path

## Entrypoints

1. **Mission Control UI** (`/internal/health`)
   - Entry: `public/internal/health/index.html`
   - Handler: `functions/internal-health.js` (embedded HTML)
   - Reads: `/data/provider-state.json` (primary), `/data/manifest.json` (fallback)
   - Evidence: `public/internal/health/index.html:412-419`

2. **Probe Endpoint** (`/api/probe/{module}`)
   - Entry: `functions/api/probe/[module].js`
   - Reads: `/data/registry/modules.json`, `/api/{module}` (probes API)
   - Evidence: `functions/api/probe/[module].js:133-150`

3. **Debug Mode** (`/api/{module}?debug=1`)
   - Entry: `functions/api/_shared/static-only-v3.js`
   - Reads: `/data/snapshots/{module}/latest.json`, `/data/registry/modules.json`, `/data/state/modules/{module}.json`, `/data/manifest.json`
   - Evidence: `functions/api/_shared/static-only-v3.js:172-199`

## OPS Data Flow

```
Mission Control UI (/internal/health)
  ↓
fetch('/data/provider-state.json')
  ↓
[if fails] fetch('/data/manifest.json')
  ↓
Display module status, proof chains, failures
```

```
Probe Endpoint (/api/probe/{module})
  ↓
Load registry: /data/registry/modules.json
  ↓
Probe API: /api/{module}
  ↓
Extract UI contract fields
  ↓
Return probe result (latency, status, UI contract check)
```

```
Debug Mode (/api/{module}?debug=1)
  ↓
Load registry: /data/registry/modules.json
  ↓
Try paths: /data/snapshots/{module}/latest.json, /data/snapshots/{module}.json, /data/{module}.json
  ↓
Load module state: /data/state/modules/{module}.json
  ↓
Load manifest: /data/manifest.json
  ↓
Evaluate proof chain
  ↓
Return debug response
```

## OPS Reads

### Control Plane Files
- `/data/provider-state.json` - Generated by Finalizer (`scripts/lib/provider-state.js`)
- `/data/manifest.json` - Generated by Finalizer (`scripts/aggregator/finalize.mjs:510-511`)
- `/data/registry/modules.json` - Registry configuration

### Data Plane Files
- `/data/snapshots/{module}/latest.json` - v3.0 snapshots (canonical)
- `/data/snapshots/{module}.json` - Legacy flat files (fallback)
- `/data/state/modules/{module}.json` - Module state files

### Evidence
- `scripts/aggregator/finalize.mjs:510-511` - Writes manifest
- `scripts/lib/provider-state.js:40-175` - Generates provider-state
- `functions/api/_shared/static-only-v3.js:294-317` - Reads snapshots
- `public/internal/health/index.html:412` - Reads provider-state
